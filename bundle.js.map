{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/sketch.js","webpack:///./src/oflow/webcamFlow.js","webpack:///./src/index.js","webpack:///./node_modules/stats-js/build/stats.min.js","webpack:///./src/oflow/videoFlow.js","webpack:///./src/oflow/flowCalculator.js","webpack:///./src/oflow/flowZone.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","root","window","this","document","MATH_PROPS","split","M","Math","CANVAS","DOM","doc","win","instances","defaults","fullscreen","autostart","autoclear","autopause","container","body","interval","globals","retina","type","keyMap","8","9","13","16","27","32","37","38","39","40","isFunction","isString","extend","target","source","overwrite","proxy","method","context","apply","arguments","constructor","request","handler","parent","bounds","index","suffix","clock","node","copy","val","min","max","w","h","counter","touches","resized","setup","ratio","devicePixelRatio","isDiv","is2D","mouse","x","y","ox","oy","dx","dy","eventMap","eventTarget","element","pointer","event","code","keyCode","keys","String","fromCharCode","trigger","stop","start","resize","splice","on","length","passive","capture","style","canvas","width","height","innerHeight","innerWidth","scale","augment","touch","getBoundingClientRect","pageX","left","scrollX","pageXOffset","pageY","top","scrollY","pageYOffset","align","process","currentTarget","preventDefault","clone","originalEvent","indexOf","dragging","test","now","Date","running","millis","NaN","dt","destroy","parentNode","removeChild","toggle","clear","clearRect","push","update","cAF","rAF","save","draw","restore","Sketch","WEB_GL","WEBGL","install","TWO_PI","PI","HALF_PI","QUARTER_PI","random","toString","isNumber","lerp","amount","map","num","minA","maxA","minB","maxB","options","self","createElement","getContext","appendChild","className","vendors","scope","then","a","b","callback","id","setTimeout","clearTimeout","factory","VideoFlow","require","defaultVideoTag","zoneSize","cameraFacing","videoTag","isCapturing","localStream","videoFlow","calculatedCallbacks","onWebCamFail","e","alert","gotFlow","direction","forEach","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","startCapture","setAttribute","MediaStreamTrack","getSources","sourceInfos","kind","selectedVideoSource","facing","desiredDevice","optional","sourceId","video","stream","srcObject","onCalculated","mediaDevices","enumerateDevices","deviceId","initCapture","stopCapture","pause","__webpack_exports__","_sketch__WEBPACK_IMPORTED_MODULE_0__","_sketch__WEBPACK_IMPORTED_MODULE_0___default","_oflow_webcamFlow__WEBPACK_IMPORTED_MODULE_2__","_oflow_webcamFlow__WEBPACK_IMPORTED_MODULE_2___default","console","log","webcamFlow","sketch","position","backgroundColor","ctx","particleSystem","positions","velocities","numParticles","world","sqr","dist2","v","distToSegmentSquared","l2","gravity","b2Vec2","b2World","bd","b2BodyDef","b2_staticBody","CreateBody","b1","b2PolygonShape","SetAsBoxXYCenterAngle","CreateFixtureFromShape","b2","b3","b4","psd","b2ParticleSystemDef","radius","dampingStrength","surfaceTensionNormalStrength","surfaceTensionPressureStrength","CreateParticleSystem","box","particleGroupDef","b2ParticleGroupDef","shape","flags","b2_tensileParticle","CreateParticleGroup","GetPositionBuffer","GetVelocityBuffer","m1","m2","Step","setTransform","fillStyle","vx","vy","sqrt","floor","pow","g","rad","beginPath","arc","fill","touchstart","dom","children","display","cssText","addEventListener","performance","f","Panel","memory","REVISION","addPanel","showPanel","begin","end","usedJSHeapSize","jsHeapSizeLimit","domElement","setMode","round","u","font","textBaseline","fillRect","fillText","globalAlpha","drawImage","FlowCalculator","oldImage","loopId","calculator","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","cancelAnimFrame","cancelAnimationFrame","mozCancelAnimationFrame","calculate","newImage","videoWidth","videoHeight","imgd","getImageData","data","getCurrentPixels","zones","animloop","err","Error","message","initView","getWidth","getHeight","FlowZone","step","A2","A1B2","B1","C1","C2","uu","vv","winStep","globalY","globalX","localY","localX","wMax","hMax","address","gradX","gradY","gradT","delta","Idelta","norm","temp"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,SAIAlC,IAAAmC,EAAA,qBC/EC,IAAWC,IAkBS,oBAAXC,OAAyBA,OAASC,KAbxCnC,EAAOD,QAauC,SAAWmC,EAAQE,GAGnE,aAUA,IAAIC,EAAa,0HAA0HC,MAAO,KAE9IC,EAAIC,KAEJC,EAAS,SAETC,EAAM,MAENC,EAAMP,EACNQ,EAAMV,EAENW,EAAY,GAEZC,EAAW,CAEbC,YAAY,EACZC,WAAW,EACXC,WAAW,EACXC,WAAW,EACXC,UAAWR,EAAIS,KACfC,SAAU,EACVC,SAAS,EACTC,QAAQ,EACRC,KAAMf,GAGJgB,EAAS,CAEVC,EAAG,YACHC,EAAG,MACJC,GAAI,QACJC,GAAI,QACJC,GAAI,SACJC,GAAI,QACJC,GAAI,OACJC,GAAI,KACJC,GAAI,QACJC,GAAI,QAgBN,SAASC,EAAYzC,GAEnB,MAAwB,mBAAVA,EAQhB,SAAS0C,EAAU1C,GAEjB,MAAwB,iBAAVA,EAQhB,SAAS2C,EAAQC,EAAQC,EAAQC,GAE/B,IAAM,IAAIjD,KAAOgD,GAEVC,GAAgBjD,KAAO+C,IAE1BA,EAAQ/C,GAAQgD,EAAQhD,IAE5B,OAAO+C,EAGT,SAASG,EAAOC,EAAQC,GAEtB,OAAO,WAELD,EAAOE,MAAOD,EAASE,YAiC3B,SAASC,EAAaH,GAEpB,IAAII,EAASC,EAASV,EAAQW,EAAQC,EAAQC,EAAOC,EAAQC,EAAOC,EAAMC,EAAMhC,EAAMhC,EAAKiE,EAAKC,EAAKC,EAAKC,EAAGC,EAEzGC,EAAU,EACVC,EAAU,GACVC,GAAU,EACVC,GAAQ,EACRC,EAAQtD,EAAIuD,kBAAoB,EAChCC,EAAQxB,EAAQpB,MAAQd,EACxB2D,EAAOzB,EAAQpB,MAAQf,EAEvB6D,EAAQ,CACVC,EAAI,EAAKC,EAAI,EACbC,GAAI,EAAKC,GAAI,EACbC,GAAI,EAAKC,GAAI,GAGXC,EAAW,CAEbjC,EAAQkC,aAAelC,EAAQmC,QAE7BC,EAAS,YAAa,aACtBA,EAAS,YAAa,YACtBA,EAAS,UAAW,WACpBA,EAAS,QACTA,EAAS,WACTA,EAAS,YAEXrE,EAyNF,SAAmBsE,GA3SrB,IAAkBC,EA6Sd1F,EAAMyF,EAAME,QACZ1B,EAAoB,SAAdwB,EAAMzD,KACZ4D,EAAM5F,GAAQ4F,GA/SAF,EA+Se1F,EA7SxBiC,EAAQyD,IAAUG,OAAOC,aAAcJ,MA6SJzB,EAExC8B,EAAS3C,EAASqC,EAAMzD,MAAQyD,IA7NpB,UAAW,QAEvBrE,EA8NF,SAAiBqE,GAEVrC,EAAQ1B,YAEK,QAAd+D,EAAMzD,KAAiBgE,EAAOC,KAElCF,EAAS3C,EAASqC,EAAMzD,MAAQyD,IAlOtB,QAAS,OACjBS,EAAQ,UAGRN,EAAO,GAAI,IAAM5F,KAAOiC,EAAS2D,EAAM3D,EAAQjC,KAAU,EAE7D,SAAS+F,EAAS5C,GAEXP,EAAYO,IAEfA,EAAOE,MAAOD,EAAS,GAAG+C,OAAOvH,KAAM0E,UAAW,IAGtD,SAASrD,EAAMmG,GAEb,IAAMxC,EAAQ,EAAGA,EAAQyB,EAASgB,OAAQzC,IAInCf,EAFLkB,EAAOsB,EAAUzB,IAIjBb,GAAUqD,EAAK,MAAQ,UAAa,iBAAkBxH,KAAMmE,EAAQgB,EAAMN,EAAS,CACjF6C,SAAS,EACTC,SAAS,IAGD3D,EAAYmB,GAEpBN,EAAUM,EAEPhB,EAASgB,EA4DlB,SAASmC,IAEPnD,EAAS6B,EAAQxB,EAAQoD,MAAQpD,EAAQqD,OACzC5C,EAASe,EAAQ,KAAO,GAExBR,EAAIhB,EAAQsD,MACZrC,EAAIjB,EAAQuD,OAEPvD,EAAQ7B,aAEX8C,EAAIjB,EAAQuD,OAASvF,EAAIwF,YACzBxC,EAAIhB,EAAQsD,MAAQtF,EAAIyF,YAGrBzD,EAAQrB,QAAU8C,GAAQH,IAE7B3B,EAAOyD,MAAMG,OAAStC,EAAI,KAC1BtB,EAAOyD,MAAME,MAAQtC,EAAI,KAEzBA,GAAKM,EACLL,GAAKK,GAGF3B,EAAO4D,SAAWtC,IAErBtB,EAAO4D,OAAStC,EAAIR,GAEjBd,EAAO2D,QAAUtC,IAEpBrB,EAAO2D,MAAQtC,EAAIP,GAEhBgB,IAASzB,EAAQ3B,WAAa2B,EAAQrB,QAEzCqB,EAAQ0D,MAAOpC,EAAOA,GAEnBD,GAAQsB,EAAS3C,EAAQ8C,QAahC,SAASa,EAASC,EAAOjE,GAevB,OAzBF,SAAgBiE,EAAOjE,GAErBY,EAASZ,EAAOkE,wBAEhBD,EAAMjC,EAAIiC,EAAME,MAAQvD,EAAOwD,MAAQ/F,EAAIgG,SAAWhG,EAAIiG,aAC1DL,EAAMhC,EAAIgC,EAAMM,MAAQ3D,EAAO4D,KAAOnG,EAAIoG,SAAWpG,EAAIqG,aAOzDC,CAAOV,EAAO5D,EAAQmC,UAEtBxC,EAASA,GAAU,IAEZkC,GAAKlC,EAAOgC,GAAKiC,EAAMjC,EAC9BhC,EAAOmC,GAAKnC,EAAOiC,GAAKgC,EAAMhC,EAE9BjC,EAAOgC,EAAIiC,EAAMjC,EACjBhC,EAAOiC,EAAIgC,EAAMhC,EAEjBjC,EAAOoC,GAAKpC,EAAOgC,EAAIhC,EAAOkC,GAC9BlC,EAAOqC,GAAKrC,EAAOiC,EAAIjC,EAAOmC,GAEvBnC,EAGT,SAAS4E,EAASlC,GAShB,GAPKA,EAAMmC,gBAAkBxE,EAAQmC,SAEnCE,EAAMoC,kBAER7D,EAlOJ,SAAgBjB,GAEd,IAAI5C,EAAS,GAEb,IAAM,IAAIH,KAAO+C,EAEF,oBAAR/C,GAAqC,oBAARA,IAG7B4C,EAAYG,EAAQ/C,IAEvBG,EAAQH,GAAQkD,EAAOH,EAAQ/C,GAAO+C,GAItC5C,EAAQH,GAAQ+C,EAAQ/C,IAG5B,OAAOG,EAgNE2H,CAAOrC,IACTsC,cAAgBtC,EAEhBzB,EAAKO,QAIR,IAFAA,EAAQ8B,OAASrC,EAAKO,QAAQ8B,OAExBzC,EAAQ,EAAGA,EAAQI,EAAKO,QAAQ8B,OAAQzC,IAE5CW,EAASX,GAAUmD,EAAS/C,EAAKO,QAASX,GAASW,EAASX,SAI9DW,EAAQ8B,OAAS,EACjB9B,EAAQ,GAAKwC,EAAS/C,EAAMc,GAK9B,OAFAhC,EAAQgC,EAAOP,EAAQ,IAAI,GAEpBP,EAGT,SAASwB,EAASC,GAchB,IAZAA,EAAQkC,EAASlC,GAEjBvB,GAAQC,EAAMkB,EAAS2C,QAAShG,EAAOyD,EAAMzD,OAAW,EAExDoB,EAAQ6E,WAEN,aAAaC,KAAMlG,KAEnB,SAASkG,KAAMlG,IAEfoB,EAAQ6E,SAEH/D,GAELrB,EAAUwC,EAAUnB,IAElB6B,EAAS3C,EAASiC,EAAUnB,MAAWuB,GAEzC5C,EAAUwC,EAAUlB,IAElB4B,EAAS3C,EAASiC,EAAUlB,MAAWsB,GAEzCvB,EAAM,EAuBV,SAAS+B,IAEP7C,EAAQ+E,KAAO,IAAIC,KACnBhF,EAAQiF,SAAU,EAGpB,SAASrC,IAEP5C,EAAQiF,SAAU,EAgDpB,OArBAvF,EAAQM,EAAS,CAEfmB,QAASA,EACTO,MAAOA,EACPc,KAAMA,EAENqC,UAAU,EACVI,SAAS,EACTC,OAAQ,EACRH,IAAKI,IACLC,GAAID,IAEJE,QAxBF,WAEE/E,EAASN,EAAQmC,QAAQmD,WACzB9E,EAAQvC,EAAU2G,QAAS5E,GAEtBM,GAASA,EAAOiF,YAAavF,EAAQmC,UACpC3B,GAAQvC,EAAU8E,OAAQvC,EAAO,GAEvC3D,GAAM,GACN+F,KAgBA4C,OArCF,YAEIxF,EAAQiF,QAAUrC,EAAOC,MAoC3B4C,MAjCF,WAEOhE,GAEHzB,EAAQ0F,UAAW,EAAG,EAAG1F,EAAQsD,MAAQhC,EAAOtB,EAAQuD,OAASjC,IA8BnEuB,MAAOA,EACPD,KAAMA,IAGR3E,EAAU0H,KAAM3F,GAEPA,EAAQ5B,WAAayE,IAAShG,GAAM,GAAQiG,IA7PrD,SAAS8C,IAEPC,EAAKzF,GACLA,EAAU0F,EAAKF,GAETvE,IAEJsB,EAAS3C,EAAQqB,OACjBA,EAAQ7B,EAAYQ,EAAQqB,QAGxBD,IACJuB,EAAS3C,EAAQ8C,QACjB1B,EAAU5B,EAAYQ,EAAQ8C,SAG3B9C,EAAQiF,UAAY/D,IAEvBlB,EAAQoF,IAAO1E,GAAS,IAAIsE,MAAWhF,EAAQ+E,IAC/C/E,EAAQkF,QAAUlF,EAAQoF,GAC1BpF,EAAQ+E,IAAMrE,EAEdiC,EAAS3C,EAAQ4F,QAIZnE,IAEEzB,EAAQrB,SAEXqB,EAAQ+F,OAEJ/F,EAAQ3B,WACV2B,EAAQ0D,MAAOpC,EAAOA,IAIrBtB,EAAQ3B,WAEX2B,EAAQyF,SAKZ9C,EAAS3C,EAAQgG,MAIZvE,GAAQzB,EAAQrB,QAEnBqB,EAAQiG,WAGZ/E,IAAYA,EAAUlB,EAAQvB,SAwM+BmH,GAAU5F,EA8H3E,IAnHA,IAAImC,EAASnC,EAASkG,EAAS,CAE7BrI,OAAQA,EACRsI,OApcU,QAqcVC,MArcU,QAscVtI,IAAKA,EAELG,UAAWA,EAEXoI,QAAS,SAAUrG,GAEjB,IAAMA,EAAO,YAAiB,CAE5B,IAAM,IAAI3E,EAAI,EAAGA,EAAIoC,EAAWwF,OAAQ5H,IAEtC2E,EAASvC,EAAWpC,IAAOsC,EAAGF,EAAWpC,IAE3CqE,EAAQM,EAAS,CAEfsG,OAAe,EAAP3I,EAAE4I,GACVC,QAAS7I,EAAE4I,GAAK,EAChBE,WAAY9I,EAAE4I,GAAK,EAEnBG,OAAQ,SAAU5F,EAAKC,GAErB,OA/aQhE,EA+aM+D,EA7a6B,kBAA5C/E,OAAOkB,UAAU0J,SAASnL,KAAMuB,GA+atB+D,KAASnD,EAAE+I,SAAW5F,EAAImC,UAva7C,SAAmBlG,GAEjB,MAAwB,iBAAVA,EAuaA6J,CAAU7F,KAEdA,EAAMD,GAAO,EAAGA,EAAM,GAEjBA,EAAMnD,EAAE+I,UAAa3F,EAAMD,IAvb5C,IAAkB/D,GA0bV8J,KAAM,SAAU/F,EAAKC,EAAK+F,GAExB,OAAOhG,EAAMgG,GAAW/F,EAAMD,IAGhCiG,IAAK,SAAUC,EAAKC,EAAMC,EAAMC,EAAMC,GAEpC,OAASJ,EAAMC,IAAWC,EAAOD,IAAWG,EAAOD,GAASA,KAIhEnH,EAAO,aAAiB,IAI5BrD,OAAQ,SAAU0K,GA6BhB,OA3BAA,EAAU3H,EAAQ2H,GAAW,GAAInJ,IAEpBQ,SAAUwH,EAAOG,QAASiB,MAEvCnF,EAAUkF,EAAQlF,QAAUkF,EAAQlF,SAAWpE,EAAIwJ,cAAeF,EAAQzI,OAASd,EAAM,MAAQ,UAEjGkC,EAAUqH,EAAQrH,QAAUqH,EAAQrH,SAAY,WAE9C,OAAQqH,EAAQzI,MAEd,KAAKf,EAEH,OAAOsE,EAAQqF,WAAY,KAAMH,GAEnC,IApgBI,QAsgBF,OAAOlF,EAAQqF,WAAY,QAASH,IAAalF,EAAQqF,WAAY,qBAAsBH,GAE7F,KAAKvJ,EAEH,OAAOqE,EAAQkB,OAASlB,GAdkB,IAmB9CkF,EAAQ9I,WAAaR,EAAIS,MAAOiJ,YAAatF,GAExC+D,EAAOvC,QAAS3D,EAASqH,IAGlC1D,QAAS,SAAU3D,EAASqH,GAS1B,OAPAA,EAAU3H,EAAQ2H,GAAW,GAAInJ,IAEzBiE,QAAUnC,EAAQqD,QAAUrD,EACpCqH,EAAQlF,QAAQuF,WAAa,UAE7BhI,EAAQM,EAASqH,GAAS,GAEnBlH,EAAaH,KAYpB2H,EAAU,CAAE,KAAM,MAAO,SAAU,KACnCC,EAAQN,KACRO,EAAO,EAEPC,EAAI,iBACJC,EAAI,UAAYD,EAChBpM,EAAI,SAAWoM,EAEfhC,EAAM8B,EAAOG,GACblC,EAAM+B,EAAOlM,GAEPL,EAAI,EAAGA,EAAIsM,EAAQ1E,SAAW6C,EAAKzK,IAE3CyK,EAAM8B,EAAOD,EAAStM,GAAM,UAAYyM,GACxCjC,EAAM+B,EAAOD,EAAStM,GAAM,SAAWyM,GA2BzC,OAxBAF,EAAOG,GAAMjC,EAAMA,GAAO,SAAUkC,GAElC,IAAIjD,GAAO,IAAIC,KACXI,EAAKzH,EAAEoD,IAAK,EAAG,IAAOgE,EAAM8C,IAC5BI,EAAKC,WAAY,WACnBF,EAAUjD,EAAMK,IACfA,GAGH,OADAyC,EAAO9C,EAAMK,EACN6C,GAGTL,EAAOlM,GAAMmK,EAAMA,GAAO,SAAUoC,GAClCE,aAAcF,IAWT/B,EAjnBYkC,CAAQ/K,EAAMA,EAAKG,2BCNxC,IAAI6K,EAAYC,EAAQ,GACxBlN,EAAOD,QA4BP,SAAoBoN,EAAiBC,EAAUC,GAC3C,IAAIC,EACAC,EACAC,EAGAC,EAFAC,EAAsB,GAGtBC,EAAe,SAAsBC,GACnB,IAAXA,EAAE1G,KACDhF,OAAO2L,MAAM,gEAEb3L,OAAO2L,MAAM,qDAGrBC,EAAU,SAASC,GACfL,EAAoBM,QAAQ,SAAUpB,GAClCA,EAASmB,MAiEhBE,UAAUC,eACXD,UAAUC,aAAeD,UAAUC,cACVD,UAAUE,oBACVF,UAAUG,iBACVH,UAAUI,gBAIvClM,KAAKmM,aAAe,WACXf,GAvES,WACTE,KACDH,EAAWH,GAAmBjL,OAAOE,SAAS+J,cAAc,UACnDoC,aAAa,YAAY,GAClCd,EAAY,IAAIR,EAAUK,EAAUF,IAMpClL,OAAOsM,iBAAiBC,WACxBvM,OAAOsM,iBAAiBC,WAAW,SAASC,GACxC,IAAK,IAAIzO,EAAI,EAAGA,EAAIyO,EAAY7G,SACA,UAAxB6G,EAAYzO,GAAG0O,OACfC,oBAAsBF,EAAYzO,GAAG4M,GAEjC6B,EAAYzO,GAAG4O,SAAWxB,IAJEpN,KAUxC6O,cAAgB,CAAEC,SAAU,CAAC,CAACC,SAAUJ,uBAExCX,UAAUC,aAAa,CAAEe,MAAOH,eAAiB,SAASI,GACtD3B,GAAc,EACdC,EAAc0B,EACd5B,EAAS6B,UAAYD,EACjBA,IACAzB,EAAUa,aAAahB,GACvBG,EAAU2B,aAAatB,KAE5BH,KAEDM,UAAUoB,aAAaC,kBAC7BrB,UAAUoB,aAAaC,mBAAmB7C,KACtC,SAASiC,GACL,IAAK,IAAIzO,EAAI,EAAGA,EAAIyO,EAAY7G,OAAQ5H,IACV,cAAvByO,EAAYzO,GAAG0O,OACdC,oBAAsBF,EAAYzO,GAAGsP,UAI7CT,cAAgB,CAAEC,SAAU,CAAC,CAACC,SAAUJ,uBAExCX,UAAUC,aAAa,CAAEe,MAAOH,eAAiB,SAASI,GACtD3B,GAAc,EACdC,EAAc0B,EACd5B,EAAS6B,UAAaD,EAClBA,IACAzB,EAAUa,aAAahB,GACvBG,EAAU2B,aAAatB,KAE5BH,KAmBX6B,IAGRrN,KAAKiN,aAAe,SAAUxC,GAC1Bc,EAAoBnD,KAAKqC,IAE7BzK,KAAKsN,YAAc,WACflC,GAAc,EACVE,GAAaA,EAAUgC,cACvBnC,GAAYA,EAASoC,QACrBlC,GAAeA,EAAYhG,uECpIvC3H,EAAAkB,EAAA4O,GAAA,IAAAC,EAAA/P,EAAA,GAAAgQ,EAAAhQ,EAAA6B,EAAAkO,GAAAE,GAAAjQ,EAAA,GAAAA,EAAA,IAAAkQ,EAAAlQ,EAAA6B,EAAAoO,GAIAE,QAAQC,IAAIC,KAEZ,IAAIC,EAASrF,IAAOvJ,OAAO,CACvBuF,YAAa1E,SAASgB,KACtBD,UAAWf,SAASgB,KACpBG,OAAQ,SAGRyE,EAAQmI,EAAOpJ,QAAQiB,MAC3BA,EAAMoI,SAAW,WACjBpI,EAAMW,KAAO,MACbX,EAAMe,IAAM,MACZf,EAAMqI,gBAAkB,OAExB,IAAIC,EAAMH,EAUV,IAGII,EACAC,EACAC,EACAC,EAJAC,EAAQ,KAqDZ,SAASC,EAAIrK,GAAK,OAAOA,EAAIA,EAC7B,SAASsK,EAAMC,EAAGlL,GAAK,OAAOgL,EAAIE,EAAEvK,EAAIX,EAAEW,GAAKqK,EAAIE,EAAEtK,EAAIZ,EAAEY,GAC3D,SAASuK,EAAqBhP,EAAG+O,EAAGlL,GAClC,IAAIoL,EAAKH,EAAMC,EAAGlL,GAClB,GAAU,GAANoL,EAAS,OAAOH,EAAM9O,EAAG+O,GAC7B,IAAI3P,IAAMY,EAAEwE,EAAIuK,EAAEvK,IAAMX,EAAEW,EAAIuK,EAAEvK,IAAMxE,EAAEyE,EAAIsK,EAAEtK,IAAMZ,EAAEY,EAAIsK,EAAEtK,IAAMwK,EAElE,OADA7P,EAAIqB,KAAKmD,IAAI,EAAGnD,KAAKkD,IAAI,EAAGvE,IACrB0P,EAAM9O,EAAG,CAAEwE,EAAGuK,EAAEvK,EAAIpF,GAAKyE,EAAEW,EAAIuK,EAAEvK,GACtBC,EAAGsK,EAAEtK,EAAIrF,GAAKyE,EAAEY,EAAIsK,EAAEtK,KAvD1C2J,EAAOlK,MAAQ,MACX,IAAIgL,EAAU,IAAIC,OAAO,EAAG,IAC5BP,EAAQzO,OAAOyO,MAAQ,IAAIQ,QAAQF,GAEnC,IAAIG,EAAK,IAAIC,UACbD,EAAG5N,KAAO8N,cAEV,IAAIlO,EAAOuN,EAAMY,WAAWH,GAExBI,EAAK,IAAIC,eACbD,EAAGE,sBAAsB,IAAM,EAAG,IAAIR,OAAO,IAAK,GAAI,GACtD9N,EAAKuO,uBAAuBH,EAAI,GAEhC,IAAII,EAAK,IAAIH,eACbG,EAAGF,sBAAsB,IAAM,EAAG,IAAIR,QAAQ,IAAK,GAAI,GACvD9N,EAAKuO,uBAAuBC,EAAI,GAEhC,IAAIC,EAAK,IAAIJ,eACbI,EAAGH,sBAAsB,EAAG,IAAM,IAAIR,OAAO,EAAG,KAAM,GACtD9N,EAAKuO,uBAAuBE,EAAI,GAEhC,IAAIC,EAAK,IAAIL,eACbK,EAAGJ,sBAAsB,EAAG,IAAM,IAAIR,OAAO,GAAI,KAAM,GACvD9N,EAAKuO,uBAAuBG,EAAI,GAGhC,IAAIC,EAAM,IAAIC,oBACdD,EAAIE,OAAS,KACbF,EAAIG,gBAAkB,GACtBH,EAAII,6BAA+B,KACnCJ,EAAIK,+BAAiC,KAErC7B,EAAiBI,EAAM0B,qBAAqBN,GAC5C,IAAIO,EAAM,IAAIb,eACda,EAAIZ,sBAAsB,IAAK,GAAK,IAAIR,OAAO,EAAG,IAAM,GAExD,IAAIqB,EAAmB,IAAIC,mBAC3BD,EAAiBE,MAAQH,EACzBC,EAAiBG,MAAQC,mBACLpC,EAAeqC,oBAAoBL,GAEvD/B,EAAYD,EAAesC,oBAC3BpC,EAAaF,EAAeuC,oBAC5BpC,EAAeF,EAAU3I,SAgB7BsI,EAAO3F,OAAS,MAMZ,IAAIrC,EAASmI,EAAInI,OACbD,EAAQoI,EAAIpI,MAEZ5B,EAAQgK,EAAIhK,MACZyM,EAAK,CACLxM,GAAID,EAAMG,GAAKyB,EAAQ,GAAKC,EAAS,EACrC3B,GAAIF,EAAMI,GAAKyB,EAAS,GAAKA,EAAS,GAEtC6K,EAAK,CACLzM,GAAID,EAAMC,EAAI2B,EAAQ,GAAKC,EAAS,EACpC3B,GAAIF,EAAME,EAAI2B,EAAS,GAAKA,EAAS,GAErC2I,EACIxK,EAAMK,GAAMwB,EAAS,EADzB2I,EAEIxK,EAAMM,GAAMuB,EAAS,EAI7B,IAAK,IAAIlI,EAAI,EAAGA,EAAIyQ,EAAczQ,GAAK,EACvC,CAKQ8Q,EAJM,CACNxK,EAAGiK,EAAUvQ,GACbuG,EAAGgK,EAAUvQ,EAAE,IAEW8S,EAAIC,GAAM,GAAM,KAG1CvC,EAAWxQ,IAAY,IAAN6Q,EACjBL,EAAWxQ,EAAE,IAAY,IAAN6Q,GAI3BH,EAAMsC,KAAK,EAAI,GAAK,GAzGC,EACA,KA2GzB9C,EAAOvF,KAAO,MACV,IAAIzC,EAASmI,EAAInI,OACbD,EAAQoI,EAAIpI,MAEhBoI,EAAI4C,aAAa/K,EAAQ,EAAG,EAAGA,EAAQD,EAAOC,GAE9CmI,EAAI6C,UAAY,OAEhB,IAAK,IAAIlT,EAAI,EAAGA,EAAIyQ,EAAczQ,GAAK,EACvC,CACI,IAAIsG,EAAIiK,EAAUvQ,GACduG,EAAIgK,EAAUvQ,EAAE,GAChBmT,EAAK3C,EAAWxQ,GAChBoT,EAAK5C,EAAWxQ,EAAE,GAClB6Q,EAAItO,KAAK8Q,KAAKF,EAAGA,EAAKC,EAAGA,GAC7BvC,EAAInF,IAAImF,EAAG,EAAG,IAAK,EAAG,GACtB,IAAI/P,EAAIwS,MAAoB,IAAdC,IAAI1C,EAAG,KACjB2C,EAAI1S,EACJ4L,EAAI4G,MAAoB,IAAdC,IAAI1C,EAAG,KACjBpE,EAAI,GAER4D,EAAI6C,UAAY,QAAUpS,EAAI,IAAM0S,EAAI,IAAM9G,EAAI,IAAMD,EAAI,IAE5D,IAAIgH,EAAM/H,IAAI6H,IAAI1C,EAAG,GAAI,EAAG,EAAG,KAAO,MAEtCR,EAAIqD,YACJrD,EAAIsD,IAAIrN,EAAGC,EAAGkN,EAAK,EAAGxI,QACtBoF,EAAIuD,UAIZ1D,EAAO2D,WAAc7M,KACjBA,EAAMoC,oCCxKyDrJ,EAAAD,QAAgF,WAAiB,aAAa,IAAAO,EAAA,WAAiB,IAAAoB,EAAA,EAAAxB,EAAAkC,SAAA+J,cAAA,OAAwC,SAAAyB,KAAc,OAAA1N,EAAAmM,YAAAuB,EAAAmG,KAAAnG,EAA8B,SAAAzM,EAAAyM,GAAc,QAAAzM,EAAA,EAAYA,EAAAjB,EAAA8T,SAAAnM,OAAoB1G,IAAAjB,EAAA8T,SAAA7S,GAAA6G,MAAAiM,QAAA9S,IAAAyM,EAAA,eAAqDlM,EAAAkM,EAAI1N,EAAA8H,MAAAkM,QAAA,uEAAwEhU,EAAAiU,iBAAA,iBAAAvG,GAAsDA,EAAAvE,iBAAAlI,IAAAO,EAAAxB,EAAA8T,SAAAnM,UAA4C,GAAK,IAAA5H,GAAAmU,aAAAxK,MAAAD,MAAA+C,EAAAzM,EAAAS,EAAA,EAAA2T,EAAAzG,EAAA,IAAAtN,EAAAgU,MAAA,sBAAAvT,EAAA6M,EAAA,IAAAtN,EAAAgU,MAAA,qBAAmH,GAAApI,KAAAkI,aAAAlI,KAAAkI,YAAAG,OAAA,IAAAhU,EAAAqN,EAAA,IAAAtN,EAAAgU,MAAA,qBAAsF,OAAAnT,EAAA,IAAaqT,SAAA,GAAAT,IAAA7T,EAAAuU,SAAA7G,EAAA8G,UAAAvT,EAAAwT,MAAA,WAA0D1U,GAAAmU,aAAAxK,MAAAD,OAA4BiL,IAAA,WAAgBlU,IAAI,IAAAkN,GAAAwG,aAAAxK,MAAAD,MAAgC,GAAA5I,EAAAyJ,OAAAoD,EAAA3N,EAAA,KAAAyM,EAAA,KAAAkB,IAAAyG,EAAA7J,OAAA,IAAA9J,GAAAkN,EAAAlB,GAAA,KAAAA,EAAAkB,EAAAlN,EAAA,EAAAH,GAAA,CAAsE,IAAAY,EAAAiT,YAAAG,OAAyBhU,EAAAiK,OAAArJ,EAAA0T,eAAA,QAAA1T,EAAA2T,gBAAA,SAA6D,OAAAlH,GAASpD,OAAA,WAAmBvK,EAAAkC,KAAAyS,OAAaG,WAAA7U,EAAA8U,QAAA7T,IAA0B,OAAAb,EAAAgU,MAAA,SAAA5S,EAAAxB,EAAAD,GAA+B,IAAAyM,EAAA,IAAAhM,EAAA,EAAA2T,EAAA7R,KAAAyS,MAAAlU,EAAAsT,EAAAnS,OAAAiE,kBAAA,GAAA5F,EAAA,GAAAQ,EAAA6M,EAAA,GAAA7M,EAAAT,EAAA,EAAAS,EAAAgB,EAAA,EAAAhB,EAAAmU,EAAA,EAAAnU,EAAAiB,EAAA,GAAAjB,EAAAV,EAAA,GAAAU,EAAA8E,EAAA,GAAA9E,EAAAyF,EAAApE,SAAA+J,cAAA,UAAmJ3F,EAAA0B,MAAA3H,EAAAiG,EAAA2B,OAAAyF,EAAApH,EAAAwB,MAAAkM,QAAA,yBAA8D,IAAApD,EAAAtK,EAAA4F,WAAA,MAAyB,OAAA0E,EAAAqE,KAAA,UAAApU,EAAA,gCAAA+P,EAAAsE,aAAA,MAAAtE,EAAAqC,UAAAlT,EAAA6Q,EAAAuE,SAAA,IAAA9U,EAAAqN,GAAAkD,EAAAqC,UAAAjT,EAAA4Q,EAAAwE,SAAA5T,EAAApB,EAAAyB,GAAA+O,EAAAuE,SAAAH,EAAAlT,EAAA3B,EAAAwF,GAAAiL,EAAAqC,UAAAlT,EAAA6Q,EAAAyE,YAAA,GAAAzE,EAAAuE,SAAAH,EAAAlT,EAAA3B,EAAAwF,GAAA,CAAyNkO,IAAAvN,EAAAgE,OAAA,SAAAoD,EAAAzM,GAA2BuL,EAAAlK,KAAAkD,IAAAgH,EAAAkB,GAAAlN,EAAA8B,KAAAmD,IAAAjF,EAAAkN,GAAAkD,EAAAqC,UAAAlT,EAAA6Q,EAAAyE,YAAA,EAAAzE,EAAAuE,SAAA,IAAA9U,EAAAyB,GAAA8O,EAAAqC,UAAAjT,EAAA4Q,EAAAwE,SAAAjB,EAAAzG,GAAA,IAAAlM,EAAA,KAAA2S,EAAA3H,GAAA,IAAA2H,EAAA3T,GAAA,IAAAJ,EAAAyB,GAAA+O,EAAA0E,UAAAhP,EAAA0O,EAAAnU,EAAAiB,EAAA3B,EAAAU,EAAA8E,EAAAqP,EAAAlT,EAAA3B,EAAAU,EAAA8E,GAAAiL,EAAAuE,SAAAH,EAAA7U,EAAAU,EAAAiB,EAAAjB,EAAA8E,GAAAiL,EAAAqC,UAAAlT,EAAA6Q,EAAAyE,YAAA,GAAAzE,EAAAuE,SAAAH,EAAA7U,EAAAU,EAAAiB,EAAAjB,EAAAsT,GAAA,EAAAzG,EAAAzM,GAAA0E,OAAmRvF,EAAxzDa,oBCEnE,IAAIsU,EAAiBvI,EAAQ,GAC7BlN,EAAOD,QAsBP,SAAmBoN,EAAiBC,GAChC,IACInF,EAEAqI,EACApI,EACAC,EACAuN,EACAC,EAPAjI,EAAsB,GAEtBuB,EAAQ9B,EAMRyI,EAAa,IAAIH,EAAerI,GAAY,GAE5CyI,EAAmB3T,OAAO4T,uBACP5T,OAAO6T,6BACP7T,OAAO8T,0BACP9T,OAAO+T,wBACP/T,OAAOgU,yBACP,SAAUtJ,GAAa1K,OAAO4K,WAAWF,EAAU,IAAO,KAC7EuJ,EAAmBjU,OAAOkU,sBACPlU,OAAOmU,wBAC1B9I,GAAc,EAcd+I,EAAY,WACR,IAAIC,EAbW,WAMf,GALArO,EAAQ+G,EAAMuH,WACdrO,EAAS8G,EAAMwH,YACfxO,EAAOC,MAASA,EAChBD,EAAOE,OAASA,EAEZD,GAASC,EAAQ,CACjBmI,EAAIkF,UAAUvG,EAAO,EAAG,GACxB,IAAIyH,EAAOpG,EAAIqG,aAAa,EAAG,EAAGzO,EAAOC,GACzC,OAAOuO,EAAKE,MAIDC,GACf,GAAInB,GAAYa,EAAU,CACtB,IAAIO,EAAQlB,EAAWU,UAAUZ,EAAUa,EAAUrO,EAAOC,GAC5DuF,EAAoBM,QAAQ,SAAUpB,GAClCA,EAASkK,KAGjBpB,EAAWa,GAUfQ,EAAW,WACHxJ,IACAoI,EAASE,EAAiBkB,GAC1BT,MAIZ,IAAKnJ,EAAiB,CAClB,IAAI6J,EAAM,IAAIC,MAEd,MADAD,EAAIE,QAAU,wBACRF,EAGV7U,KAAKmM,aAAe,WAEhBf,GAAc,EAtBH,WACPrF,EAAQ+G,EAAMuH,WACdrO,EAAS8G,EAAMwH,YAEVxO,IAAUA,EAAS/F,OAAOE,SAAS+J,cAAc,WACtDmE,EAAMrI,EAAOmE,WAAW,MAkB5B+K,GACAJ,KAEJ5U,KAAKsN,YAAc,WACf0G,EAAgBR,GAChBpI,GAAc,GAElBpL,KAAKiN,aAAe,SAAUxC,GAC1Bc,EAAoBnD,KAAKqC,IAE7BzK,KAAKiV,SAAW,WAAc,OAAOlP,GACrC/F,KAAKkV,UAAY,WAAc,OAAOlP,qBCrG1C,IAAImP,EAAWpK,EAAQ,GAUvB,SAASuI,EAAe8B,GACpBpV,KAAKoV,KAAOA,GAAQ,EATxBvX,EAAOD,QAAU0V,EAYjBA,EAAe5T,UAAUyU,UAAY,SAAUZ,EAAUa,EAAUrO,EAAOC,GACtE,IAIIqP,EAAIC,EAAMC,EAAIC,EAAIC,EAClB1C,EAAGpE,EAAG+G,EAAIC,EALVhB,EAAQ,GACRS,EAAOpV,KAAKoV,KACZQ,EAAiB,EAAPR,EAAW,EAIzBM,EAAKC,EAAK,EACV,IAEIE,EAASC,EAASC,EAAQC,EAF1BC,EAAOlQ,EAAQqP,EAAO,EACtBc,EAAOlQ,EAASoP,EAAO,EAG3B,IAAKS,EAAUT,EAAO,EAAGS,EAAUK,EAAML,GAAWD,EAChD,IAAKE,EAAUV,EAAO,EAAGU,EAAUG,EAAMH,GAAWF,EAAS,CAGzD,IAFAP,EAAKC,EAAOC,EAAKC,EAAKC,EAAK,EAEtBM,GAAUX,EAAMW,GAAUX,EAAMW,IACjC,IAAKC,GAAUZ,EAAMY,GAAUZ,EAAMY,IAAU,CAC3C,IAAIG,GAAWN,EAAUE,GAAUhQ,EAAQ+P,EAAUE,EAEjDI,EAAShC,EAAyB,GAAf+B,EAAU,IAAY/B,EAAyB,GAAf+B,EAAU,IAC7DE,EAASjC,EAA6B,GAAnB+B,EAAUpQ,IAAgBqO,EAA6B,GAAnB+B,EAAUpQ,IACjEuQ,EAAS/C,EAAmB,EAAV4C,GAAiB/B,EAAmB,EAAV+B,GAEhDd,GAAMe,EAAQA,EACdd,GAAQc,EAAQC,EAChBd,GAAMc,EAAQA,EACdZ,GAAMW,EAAQE,EACdd,GAAMa,EAAQC,EAItB,IAAIC,EAASjB,EAAOA,EAAOD,EAAKE,EAEhC,GAAc,IAAVgB,EAAa,CAEb,IAAIC,EAASpB,EAAOmB,EAIpBxD,IAHeyC,EAAKF,EAAOG,EAAKF,GAGnBiB,EACb7H,IAHe2G,EAAOG,EAAKJ,EAAKG,GAGnBgB,MACV,CAEH,IAAIC,GAAQnB,EAAOD,IAAOC,EAAOD,IAAOE,EAAKD,IAASC,EAAKD,GAC3D,GAAa,IAATmB,EAAY,CACZ,IACIC,IAASlB,EAAKC,IADFL,EAAOqB,GAGvB1D,GAAKuC,EAAOD,GAAMqB,EAClB/H,GAAK4G,EAAKD,GAAQoB,OAElB3D,EAAIpE,EAAI,GAMXiH,EAAU7C,GAAKA,EAAI6C,IACnBA,EAAUjH,GAAKA,EAAIiH,IACpBF,GAAM3C,EACN4C,GAAMhH,EACNgG,EAAMvM,KAAK,IAAI+M,EAASW,EAASD,EAAS9C,EAAGpE,KAKzD,MAAO,CACHgG,MAAQA,EACR5B,EAAI2C,EAAKf,EAAMjP,OACfiJ,EAAIgH,EAAKhB,EAAMjP,wBCtFvB7H,EAAOD,QAEP,SAAkBwG,EAAGC,EAAG0O,EAAGpE,GACvB3O,KAAKoE,EAAIA,EACTpE,KAAKqE,EAAIA,EACTrE,KAAK+S,EAAIA,EACT/S,KAAK2O,EAAIA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/flow/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","\n/* Copyright (C) 2013 Justin Windle, http://soulwire.co.uk */\n\n(function ( root, factory ) {\n\n  if ( typeof exports === 'object' ) {\n\n    // CommonJS like\n    module.exports = factory(root, root.document);\n\n  } else if ( typeof define === 'function' && define.amd ) {\n\n    // AMD\n    define( function() { return factory( root, root.document ); });\n\n  } else {\n\n    // Browser global\n    root.Sketch = factory( root, root.document );\n  }\n\n}( typeof window !== \"undefined\" ? window : this, function ( window, document ) {\n\n\n  \"use strict\";\n\n  /*\n  ----------------------------------------------------------------------\n\n    Config\n\n  ----------------------------------------------------------------------\n  */\n\n  var MATH_PROPS = 'E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min'.split( ' ' );\n  var HAS_SKETCH = '__hasSketch';\n  var M = Math;\n\n  var CANVAS = 'canvas';\n  var WEBGL = 'webgl';\n  var DOM = 'dom';\n\n  var doc = document;\n  var win = window;\n\n  var instances = [];\n\n  var defaults = {\n\n    fullscreen: true,\n    autostart: true,\n    autoclear: true,\n    autopause: true,\n    container: doc.body,\n    interval: 1,\n    globals: true,\n    retina: false,\n    type: CANVAS\n  };\n\n  var keyMap = {\n\n     8: 'BACKSPACE',\n     9: 'TAB',\n    13: 'ENTER',\n    16: 'SHIFT',\n    27: 'ESCAPE',\n    32: 'SPACE',\n    37: 'LEFT',\n    38: 'UP',\n    39: 'RIGHT',\n    40: 'DOWN'\n  };\n\n  /*\n  ----------------------------------------------------------------------\n\n    Utilities\n\n  ----------------------------------------------------------------------\n  */\n\n  function isArray( object ) {\n\n    return Object.prototype.toString.call( object ) == '[object Array]';\n  }\n\n  function isFunction( object ) {\n\n    return typeof object == 'function';\n  }\n\n  function isNumber( object ) {\n\n    return typeof object == 'number';\n  }\n\n  function isString( object ) {\n\n    return typeof object == 'string';\n  }\n\n  function keyName( code ) {\n\n    return keyMap[ code ] || String.fromCharCode( code );\n  }\n\n  function extend( target, source, overwrite ) {\n\n    for ( var key in source )\n\n      if ( overwrite || !( key in target ) )\n\n        target[ key ] = source[ key ];\n\n    return target;\n  }\n\n  function proxy( method, context ) {\n\n    return function() {\n\n      method.apply( context, arguments );\n    };\n  }\n\n  function clone( target ) {\n\n    var object = {};\n\n    for ( var key in target ) {\n      \n      if ( key === 'webkitMovementX' || key === 'webkitMovementY' )\n        continue;\n\n      if ( isFunction( target[ key ] ) )\n\n        object[ key ] = proxy( target[ key ], target );\n\n      else\n\n        object[ key ] = target[ key ];\n    }\n\n    return object;\n  }\n\n  /*\n  ----------------------------------------------------------------------\n\n    Constructor\n\n  ----------------------------------------------------------------------\n  */\n\n  function constructor( context ) {\n\n    var request, handler, target, parent, bounds, index, suffix, clock, node, copy, type, key, val, min, max, w, h;\n\n    var counter = 0;\n    var touches = [];\n    var resized = false;\n    var setup = false;\n    var ratio = win.devicePixelRatio || 1;\n    var isDiv = context.type == DOM;\n    var is2D = context.type == CANVAS;\n\n    var mouse = {\n      x:  0.0, y:  0.0,\n      ox: 0.0, oy: 0.0,\n      dx: 0.0, dy: 0.0\n    };\n\n    var eventMap = [\n\n      context.eventTarget || context.element,\n\n        pointer, 'mousedown', 'touchstart',\n        pointer, 'mousemove', 'touchmove',\n        pointer, 'mouseup', 'touchend',\n        pointer, 'click',\n        pointer, 'mouseout',\n        pointer, 'mouseover',\n\n      doc,\n\n        keypress, 'keydown', 'keyup',\n\n      win,\n\n        active, 'focus', 'blur',\n        resize, 'resize'\n    ];\n\n    var keys = {}; for ( key in keyMap ) keys[ keyMap[ key ] ] = false;\n\n    function trigger( method ) {\n\n      if ( isFunction( method ) )\n\n        method.apply( context, [].splice.call( arguments, 1 ) );\n    }\n\n    function bind( on ) {\n\n      for ( index = 0; index < eventMap.length; index++ ) {\n\n        node = eventMap[ index ];\n\n        if ( isString( node ) )\n\n        target[ ( on ? 'add' : 'remove' ) + 'EventListener' ].call( target, node, handler, {\n          passive: false,\n          capture: false,\n        });\n\n        else if ( isFunction( node ) )\n\n          handler = node;\n\n        else target = node;\n      }\n    }\n\n    function update() {\n\n      cAF( request );\n      request = rAF( update );\n\n      if ( !setup ) {\n\n        trigger( context.setup );\n        setup = isFunction( context.setup );\n      }\n\n      if ( !resized ) {\n        trigger( context.resize );\n        resized = isFunction( context.resize );\n      }\n\n      if ( context.running && !counter ) {\n\n        context.dt = ( clock = +new Date() ) - context.now;\n        context.millis += context.dt;\n        context.now = clock;\n\n        trigger( context.update );\n\n        // Pre draw\n\n        if ( is2D ) {\n\n          if ( context.retina ) {\n\n            context.save();\n            \n            if (context.autoclear) {\n              context.scale( ratio, ratio );\n            }\n          }\n\n          if ( context.autoclear )\n\n            context.clear();\n        }\n\n        // Draw\n\n        trigger( context.draw );\n\n        // Post draw\n\n        if ( is2D && context.retina )\n\n          context.restore();\n      }\n\n      counter = ++counter % context.interval;\n    }\n\n    function resize() {\n\n      target = isDiv ? context.style : context.canvas;\n      suffix = isDiv ? 'px' : '';\n\n      w = context.width;\n      h = context.height;\n\n      if ( context.fullscreen ) {\n\n        h = context.height = win.innerHeight;\n        w = context.width = win.innerWidth;\n      }\n\n      if ( context.retina && is2D && ratio ) {\n\n        target.style.height = h + 'px';\n        target.style.width = w + 'px';\n\n        w *= ratio;\n        h *= ratio;\n      }\n\n      if ( target.height !== h )\n\n        target.height = h + suffix;\n\n      if ( target.width !== w )\n\n        target.width = w + suffix;\n\n      if ( is2D && !context.autoclear && context.retina )\n\n        context.scale( ratio, ratio );\n\n      if ( setup ) trigger( context.resize );\n    }\n\n    function align( touch, target ) {\n\n      bounds = target.getBoundingClientRect();\n\n      touch.x = touch.pageX - bounds.left - (win.scrollX || win.pageXOffset);\n      touch.y = touch.pageY - bounds.top - (win.scrollY || win.pageYOffset);\n\n      return touch;\n    }\n\n    function augment( touch, target ) {\n\n      align( touch, context.element );\n\n      target = target || {};\n\n      target.ox = target.x || touch.x;\n      target.oy = target.y || touch.y;\n\n      target.x = touch.x;\n      target.y = touch.y;\n\n      target.dx = target.x - target.ox;\n      target.dy = target.y - target.oy;\n\n      return target;\n    }\n\n    function process( event ) {\n\n      if ( event.currentTarget === context.element )\n\n        event.preventDefault();\n\n      copy = clone( event );\n      copy.originalEvent = event;\n\n      if ( copy.touches ) {\n\n        touches.length = copy.touches.length;\n\n        for ( index = 0; index < copy.touches.length; index++ )\n\n          touches[ index ] = augment( copy.touches[ index ], touches[ index ] );\n\n      } else {\n\n        touches.length = 0;\n        touches[0] = augment( copy, mouse );\n      }\n\n      extend( mouse, touches[0], true );\n\n      return copy;\n    }\n\n    function pointer( event ) {\n\n      event = process( event );\n\n      min = ( max = eventMap.indexOf( type = event.type ) ) - 1;\n\n      context.dragging =\n\n        /down|start/.test( type ) ? true :\n\n        /up|end/.test( type ) ? false :\n\n        context.dragging;\n\n      while( min )\n\n        isString( eventMap[ min ] ) ?\n\n          trigger( context[ eventMap[ min-- ] ], event ) :\n\n        isString( eventMap[ max ] ) ?\n\n          trigger( context[ eventMap[ max++ ] ], event ) :\n\n        min = 0;\n    }\n\n    function keypress( event ) {\n\n      key = event.keyCode;\n      val = event.type == 'keyup';\n      keys[ key ] = keys[ keyName( key ) ] = !val;\n\n      trigger( context[ event.type ], event );\n    }\n\n    function active( event ) {\n\n      if ( context.autopause )\n\n        ( event.type == 'blur' ? stop : start )();\n\n      trigger( context[ event.type ], event );\n    }\n\n    // Public API\n\n    function start() {\n\n      context.now = +new Date();\n      context.running = true;\n    }\n\n    function stop() {\n\n      context.running = false;\n    }\n\n    function toggle() {\n\n      ( context.running ? stop : start )();\n    }\n\n    function clear() {\n\n      if ( is2D )\n\n        context.clearRect( 0, 0, context.width * ratio, context.height * ratio );\n    }\n\n    function destroy() {\n\n      parent = context.element.parentNode;\n      index = instances.indexOf( context );\n\n      if ( parent ) parent.removeChild( context.element );\n      if ( ~index ) instances.splice( index, 1 );\n\n      bind( false );\n      stop();\n    }\n\n    extend( context, {\n\n      touches: touches,\n      mouse: mouse,\n      keys: keys,\n\n      dragging: false,\n      running: false,\n      millis: 0,\n      now: NaN,\n      dt: NaN,\n\n      destroy: destroy,\n      toggle: toggle,\n      clear: clear,\n      start: start,\n      stop: stop\n    });\n\n    instances.push( context );\n\n    return ( context.autostart && start(), bind( true ), resize(), update(), context );\n  }\n\n  /*\n  ----------------------------------------------------------------------\n\n    Global API\n\n  ----------------------------------------------------------------------\n  */\n\n  var element, context, Sketch = {\n\n    CANVAS: CANVAS,\n    WEB_GL: WEBGL,\n    WEBGL: WEBGL,\n    DOM: DOM,\n\n    instances: instances,\n\n    install: function( context ) {\n\n      if ( !context[ HAS_SKETCH ] ) {\n\n        for ( var i = 0; i < MATH_PROPS.length; i++ )\n\n          context[ MATH_PROPS[i] ] = M[ MATH_PROPS[i] ];\n\n        extend( context, {\n\n          TWO_PI: M.PI * 2,\n          HALF_PI: M.PI / 2,\n          QUARTER_PI: M.PI / 4,\n\n          random: function( min, max ) {\n\n            if ( isArray( min ) )\n\n              return min[ ~~( M.random() * min.length ) ];\n\n            if ( !isNumber( max ) )\n\n              max = min || 1, min = 0;\n\n            return min + M.random() * ( max - min );\n          },\n\n          lerp: function( min, max, amount ) {\n\n            return min + amount * ( max - min );\n          },\n\n          map: function( num, minA, maxA, minB, maxB ) {\n\n            return ( num - minA ) / ( maxA - minA ) * ( maxB - minB ) + minB;\n          }\n        });\n\n        context[ HAS_SKETCH ] = true;\n      }\n    },\n\n    create: function( options ) {\n\n      options = extend( options || {}, defaults );\n\n      if ( options.globals ) Sketch.install( self );\n\n      element = options.element = options.element || doc.createElement( options.type === DOM ? 'div' : 'canvas' );\n\n      context = options.context = options.context || (function() {\n\n        switch( options.type ) {\n\n          case CANVAS:\n\n            return element.getContext( '2d', options );\n\n          case WEBGL:\n\n            return element.getContext( 'webgl', options ) || element.getContext( 'experimental-webgl', options );\n\n          case DOM:\n\n            return element.canvas = element;\n        }\n\n      })();\n\n      ( options.container || doc.body ).appendChild( element );\n\n      return Sketch.augment( context, options );\n    },\n\n    augment: function( context, options ) {\n\n      options = extend( options || {}, defaults );\n\n      options.element = context.canvas || context;\n      options.element.className += ' sketch';\n\n      extend( context, options, true );\n\n      return constructor( context );\n    }\n  };\n\n  /*\n  ----------------------------------------------------------------------\n\n    Shims\n\n  ----------------------------------------------------------------------\n  */\n\n  var vendors = [ 'ms', 'moz', 'webkit', 'o' ];\n  var scope = self;\n  var then = 0;\n\n  var a = 'AnimationFrame';\n  var b = 'request' + a;\n  var c = 'cancel' + a;\n\n  var rAF = scope[ b ];\n  var cAF = scope[ c ];\n\n  for ( var i = 0; i < vendors.length && !rAF; i++ ) {\n\n    rAF = scope[ vendors[ i ] + 'Request' + a ];\n    cAF = scope[ vendors[ i ] + 'Cancel' + a ];\n  }\n\n  scope[ b ] = rAF = rAF || function( callback ) {\n\n    var now = +new Date();\n    var dt = M.max( 0, 16 - ( now - then ) );\n    var id = setTimeout( function() {\n      callback( now + dt );\n    }, dt );\n\n    then = now + dt;\n    return id;\n  };\n\n  scope[ c ] = cAF = cAF || function( id ) {\n    clearTimeout( id );\n  };\n\n  /*\n  ----------------------------------------------------------------------\n\n    Output\n\n  ----------------------------------------------------------------------\n  */\n\n  return Sketch;\n\n}));\n","/*global navigator, window */\n\nvar VideoFlow = require('./videoFlow');\nmodule.exports = WebCamFlow;\n\n/**\n * A high level interface to capture optical flow from the web camera.\n * @param defaultVideoTag {DOMElement} optional reference to <video> tag\n *   where web camera output should be rendered. If parameter is not\n *   present a new invisible <video> tag is created.\n * @param zoneSize {int} optional size of a flow zone in pixels. 8 by default\n * @param cameraFacing {string} optional direction camera is facing (either\n * 'user' or 'environment') used to give preference to a particular mobile\n * camera. If matching camera is not found, any available one will be used.\n *\n * Usage example:\n *  var flow = new WebCamFlow();\n *\n *  // Every time when optical flow is calculated\n *  // call the passed in callback:\n *  flow.onCalculated(function (direction) {\n *      // direction is an object which describes current flow:\n *      // direction.u, direction.v {floats} general flow vector\n *      // direction.zones {Array} is a collection of flowZones.\n *      //  Each flow zone describes optical flow direction inside of it.\n *  });\n *  // Starts capturing the flow from webcamera:\n *  flow.startCapture();\n *  // once you are done capturing call\n *  flow.stopCapture();\n */\nfunction WebCamFlow(defaultVideoTag, zoneSize, cameraFacing) {\n    var videoTag,\n        isCapturing,\n        localStream,\n        calculatedCallbacks = [],\n        flowCalculatedCallback,\n        videoFlow,\n        onWebCamFail = function onWebCamFail(e) {\n            if(e.code === 1){\n                window.alert('You have denied access to your camera. I cannot do anything.');\n            } else {\n                window.alert('getUserMedia() is not supported in your browser.');\n            }\n        },\n        gotFlow = function(direction) {\n            calculatedCallbacks.forEach(function (callback) {\n                callback(direction);\n            });\n        },\n        initCapture = function() {\n        if (!videoFlow) {\n            videoTag = defaultVideoTag || window.document.createElement('video');\n            videoTag.setAttribute('autoplay', true);\n            videoFlow = new VideoFlow(videoTag, zoneSize);\n        }\n\n\n        \n\n        if (window.MediaStreamTrack.getSources) {\n            window.MediaStreamTrack.getSources(function(sourceInfos) {\n                for (var i = 0; i < sourceInfos.length; i++) {\n                    if (sourceInfos[i].kind === 'video'){\n                        selectedVideoSource = sourceInfos[i].id;\n                        // if camera facing requested direction is found, stop search\n                        if (sourceInfos[i].facing === cameraFacing) {\n                            break;\n                        }\n                    }\n                }\n\n                desiredDevice = { optional: [{sourceId: selectedVideoSource}] };\n\n                navigator.getUserMedia({ video: desiredDevice }, function(stream) {\n                    isCapturing = true;\n                    localStream = stream;\n                    videoTag.srcObject = stream;\n                    if (stream) {\n                        videoFlow.startCapture(videoTag);\n                        videoFlow.onCalculated(gotFlow);\n                    }\n                }, onWebCamFail);\n            });\n        } else if(navigator.mediaDevices.enumerateDevices) {\n            navigator.mediaDevices.enumerateDevices().then(\n                function(sourceInfos){\n                    for (var i = 0; i < sourceInfos.length; i++) {\n                        if(sourceInfos[i].kind == \"videoinput\"){\n                            selectedVideoSource = sourceInfos[i].deviceId;\n                        }\n                    }\n                    \n                    desiredDevice = { optional: [{sourceId: selectedVideoSource}] };\n\n                    navigator.getUserMedia({ video: desiredDevice }, function(stream) {\n                        isCapturing = true;\n                        localStream = stream;\n                        videoTag.srcObject = (stream);\n                        if (stream) {\n                            videoFlow.startCapture(videoTag);\n                            videoFlow.onCalculated(gotFlow);\n                        }\n                    }, onWebCamFail);\n                }\n            );\n        }\n\n\n\n    };\n\n    if (!navigator.getUserMedia) {\n        navigator.getUserMedia = navigator.getUserMedia ||\n                                 navigator.webkitGetUserMedia ||\n                                 navigator.mozGetUserMedia ||\n                                 navigator.msGetUserMedia;\n    }\n\n    // our public API\n    this.startCapture = function () {\n        if (!isCapturing) {\n            initCapture();\n        }\n    };\n    this.onCalculated = function (callback) {\n        calculatedCallbacks.push(callback);\n    };\n    this.stopCapture = function() {\n        isCapturing = false;\n        if (videoFlow) { videoFlow.stopCapture(); }\n        if (videoTag) { videoTag.pause(); }\n        if (localStream) { localStream.stop(); }\n    };\n}\n","import Sketch from './sketch';\nimport Stats from 'stats-js';\n\nimport webcamFlow from './oflow/webcamFlow';\nconsole.log(webcamFlow);\n\nlet sketch = Sketch.create({\n    eventTarget: document.body,\n    container: document.body,\n    retina: 'auto'\n});\n\nlet style = sketch.element.style;\nstyle.position = 'absolute';\nstyle.left = '0px';\nstyle.top = '0px';\nstyle.backgroundColor = '#000';\n\nlet ctx = sketch;\n\nlet stats;\nif (process.env.NODE_ENV !== 'production') {\n    stats = new Stats();\n    stats.setMode(1);\n    document.body.appendChild( stats.domElement );\n    sketch.stats = stats;\n}\n\nlet velocityIterations = 8;\nlet positionIterations = 3;\nlet world = null;\nlet particleSystem;\nlet positions;\nlet velocities;\nlet numParticles;\n\nsketch.setup = () => {\n    let gravity = new b2Vec2(0, 40.0);\n    world = window.world = new b2World(gravity); // ugh\n\n    var bd = new b2BodyDef();\n    bd.type = b2_staticBody;\n\n    let body = world.CreateBody(bd);\n\n    let b1 = new b2PolygonShape();\n    b1.SetAsBoxXYCenterAngle(0.05, 1, new b2Vec2(1.7, 0), 0);\n    body.CreateFixtureFromShape(b1, 5);\n  \n    let b2 = new b2PolygonShape();\n    b2.SetAsBoxXYCenterAngle(0.05, 1, new b2Vec2(-1.7, 0), 0);\n    body.CreateFixtureFromShape(b2, 5);\n  \n    let b3 = new b2PolygonShape();\n    b3.SetAsBoxXYCenterAngle(2, 0.05, new b2Vec2(0, 1.1), 0);\n    body.CreateFixtureFromShape(b3, 5);\n  \n    let b4 = new b2PolygonShape();\n    b4.SetAsBoxXYCenterAngle(2, 0.05, new b2Vec2(0, -1.1), 0);\n    body.CreateFixtureFromShape(b4, 5);\n\n    // setup particle system\n    let psd = new b2ParticleSystemDef();\n    psd.radius = 0.045;\n    psd.dampingStrength = 0.1;\n    psd.surfaceTensionNormalStrength = 0.004;\n    psd.surfaceTensionPressureStrength = 0.004;\n\n    particleSystem = world.CreateParticleSystem(psd);\n    let box = new b2PolygonShape();\n    box.SetAsBoxXYCenterAngle(1.5, 0.7, new b2Vec2(0, 0.3), 0);\n\n    let particleGroupDef = new b2ParticleGroupDef();\n    particleGroupDef.shape = box;\n    particleGroupDef.flags = b2_tensileParticle;\n    let particleGroup = particleSystem.CreateParticleGroup(particleGroupDef);\n\n    positions = particleSystem.GetPositionBuffer();\n    velocities = particleSystem.GetVelocityBuffer();\n    numParticles = positions.length;\n}\n\n// https://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment\nfunction sqr(x) { return x * x }\nfunction dist2(v, w) { return sqr(v.x - w.x) + sqr(v.y - w.y) }\nfunction distToSegmentSquared(p, v, w) {\n  var l2 = dist2(v, w);\n  if (l2 == 0) return dist2(p, v);\n  var t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n  t = Math.max(0, Math.min(1, t));\n  return dist2(p, { x: v.x + t * (w.x - v.x),\n                    y: v.y + t * (w.y - v.y) });\n}\nfunction distToSegment(p, v, w) { return Math.sqrt(distToSegmentSquared(p, v, w)); }\n\nsketch.update = () => {\n    if (stats) {\n        stats.end();\n        stats.begin();\n    }\n\n    let height = ctx.height;\n    let width = ctx.width;\n\n    let mouse = ctx.mouse;\n    let m1 = {\n        x: (mouse.ox - width / 2) / height * 2,\n        y: (mouse.oy - height / 2) / height * 2\n    };\n    let m2 = {\n        x: (mouse.x - width / 2) / height * 2,\n        y: (mouse.y - height / 2) / height * 2\n    };\n    let v = {\n        x: (mouse.dx) / height * 2,\n        y: (mouse.dy) / height * 2\n    };\n    // console.log(v);\n\n    for (let i = 0; i < numParticles; i += 2)\n    {\n        let pos = {\n            x: positions[i],\n            y: positions[i+1]\n        };\n        if (distToSegmentSquared(pos, m1, m2) < 0.1 * 0.1)\n        {\n            // console.log('hello');\n            velocities[i] += v.x * 300;\n            velocities[i+1] += v.y * 300;\n        }\n    }\n\n    world.Step(1 / 60 / 60, velocityIterations, positionIterations);\n}\n\nsketch.draw = () => {\n    let height = ctx.height;\n    let width = ctx.width;\n\n    ctx.setTransform(height, 1, 1, height, width, height);\n\n    ctx.fillStyle = '#AAA';\n    \n    for (let i = 0; i < numParticles; i += 2)\n    {\n        let x = positions[i];\n        let y = positions[i+1];\n        let vx = velocities[i];\n        let vy = velocities[i+1];\n        let v = Math.sqrt(vx*vx + vy*vy);\n        v = map(v, 0, 200, 0, 1);\n        let r = floor(pow(v, 0.3) * 255);\n        let g = r;\n        let b = floor(pow(v, 0.5) * 255);\n        let a = 0.7;\n        // r = g = b = 255;\n        ctx.fillStyle = 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n\n        let rad = map(pow(v, 1), 0, 1, 0.001, 0.035);\n        \n        ctx.beginPath();\n        ctx.arc(x, y, rad, 0, TWO_PI);\n        ctx.fill();\n    }\n}\n\nsketch.touchstart = (event) => {\n    event.preventDefault();\n}\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):e.Stats=t()}(this,function(){\"use strict\";var c=function(){var n=0,l=document.createElement(\"div\");function e(e){return l.appendChild(e.dom),e}function t(e){for(var t=0;t<l.children.length;t++)l.children[t].style.display=t===e?\"block\":\"none\";n=e}l.style.cssText=\"position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000\",l.addEventListener(\"click\",function(e){e.preventDefault(),t(++n%l.children.length)},!1);var i=(performance||Date).now(),a=i,o=0,f=e(new c.Panel(\"FPS\",\"#0ff\",\"#002\")),r=e(new c.Panel(\"MS\",\"#0f0\",\"#020\"));if(self.performance&&self.performance.memory)var d=e(new c.Panel(\"MB\",\"#f08\",\"#201\"));return t(0),{REVISION:16,dom:l,addPanel:e,showPanel:t,begin:function(){i=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(r.update(e-i,200),a+1e3<=e&&(f.update(1e3*o/(e-a),100),a=e,o=0,d)){var t=performance.memory;d.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:l,setMode:t}};return c.Panel=function(n,l,i){var a=1/0,o=0,f=Math.round,r=f(window.devicePixelRatio||1),d=80*r,e=48*r,c=3*r,p=2*r,u=3*r,s=15*r,m=74*r,h=30*r,y=document.createElement(\"canvas\");y.width=d,y.height=e,y.style.cssText=\"width:80px;height:48px\";var v=y.getContext(\"2d\");return v.font=\"bold \"+9*r+\"px Helvetica,Arial,sans-serif\",v.textBaseline=\"top\",v.fillStyle=i,v.fillRect(0,0,d,e),v.fillStyle=l,v.fillText(n,c,p),v.fillRect(u,s,m,h),v.fillStyle=i,v.globalAlpha=.9,v.fillRect(u,s,m,h),{dom:y,update:function(e,t){a=Math.min(a,e),o=Math.max(o,e),v.fillStyle=i,v.globalAlpha=1,v.fillRect(0,0,d,s),v.fillStyle=l,v.fillText(f(e)+\" \"+n+\" (\"+f(a)+\"-\"+f(o)+\")\",c,p),v.drawImage(y,u+r,s,m-r,h,u,s,m-r,h),v.fillRect(u+m-r,s,r,h),v.fillStyle=i,v.globalAlpha=.9,v.fillRect(u+m-r,s,r,f((1-e/t)*h))}}},c});\n","/*global window */\n\nvar FlowCalculator = require('./flowCalculator');\nmodule.exports = VideoFlow;\n\n/**\n * A high level interface to capture optical flow from the <video> tag.\n * The API is symmetrical to webcamFlow.js\n *\n * Usage example:\n *  var flow = new VideoFlow();\n *\n *  // Every time when optical flow is calculated\n *  // call the passed in callback:\n *  flow.onCalculated(function (direction) {\n *      // direction is an object which describes current flow:\n *      // direction.u, direction.v {floats} general flow vector\n *      // direction.zones {Array} is a collection of flowZones.\n *      //  Each flow zone describes optical flow direction inside of it.\n *  });\n *  // Starts capturing the flow from webcamera:\n *  flow.startCapture();\n *  // once you are done capturing call\n *  flow.stopCapture();\n */\nfunction VideoFlow(defaultVideoTag, zoneSize) {\n    var calculatedCallbacks = [],\n        canvas,\n        video = defaultVideoTag,\n        ctx,\n        width,\n        height,\n        oldImage,\n        loopId,\n        calculator = new FlowCalculator(zoneSize || 8),\n\n        requestAnimFrame = window.requestAnimationFrame       ||\n                           window.webkitRequestAnimationFrame ||\n                           window.mozRequestAnimationFrame    ||\n                           window.oRequestAnimationFrame      ||\n                           window.msRequestAnimationFrame     ||\n                           function( callback ) { window.setTimeout(callback, 1000 / 60); },\n        cancelAnimFrame =  window.cancelAnimationFrame ||\n                           window.mozCancelAnimationFrame,\n        isCapturing = false,\n\n        getCurrentPixels = function () {\n            width = video.videoWidth;\n            height = video.videoHeight;\n            canvas.width  = width;\n            canvas.height = height;\n\n            if (width && height) {\n                ctx.drawImage(video, 0, 0);\n                var imgd = ctx.getImageData(0, 0, width, height);\n                return imgd.data;\n            }\n        },\n        calculate = function () {\n            var newImage = getCurrentPixels();\n            if (oldImage && newImage) {\n                var zones = calculator.calculate(oldImage, newImage, width, height);\n                calculatedCallbacks.forEach(function (callback) {\n                    callback(zones);\n                });\n            }\n            oldImage = newImage;\n        },\n\n        initView = function () {\n            width = video.videoWidth;\n            height = video.videoHeight;\n\n            if (!canvas) { canvas = window.document.createElement('canvas'); }\n            ctx = canvas.getContext('2d');\n        },\n        animloop = function () {\n            if (isCapturing) {\n                loopId = requestAnimFrame(animloop);\n                calculate();\n            }\n        };\n\n    if (!defaultVideoTag) {\n        var err = new Error();\n        err.message = \"Video tag is required\";\n        throw err;\n    }\n\n    this.startCapture = function () {\n        // todo: error?\n        isCapturing = true;\n        initView();\n        animloop();\n    };\n    this.stopCapture = function () {\n        cancelAnimFrame(loopId);\n        isCapturing = false;\n    };\n    this.onCalculated = function (callback) {\n        calculatedCallbacks.push(callback);\n    };\n    this.getWidth = function () { return width; };\n    this.getHeight = function () { return height; };\n}\n","/*jslint sloppy: true, vars: true, plusplus: true, white: true */\n\nvar FlowZone = require('./flowZone');\n\nmodule.exports = FlowCalculator;\n\n/**\n * The heart of the optical flow detection. Implements Lucas-Kande method:\n * http://en.wikipedia.org/wiki/Lucas%E2%80%93Kanade_method\n * Current implementation is not extremely tolerant to garbage collector.\n * This could be improved...\n */\nfunction FlowCalculator(step) {\n    this.step = step || 8;\n}\n\nFlowCalculator.prototype.calculate = function (oldImage, newImage, width, height) {\n    var zones = [];\n    var step = this.step;\n    var winStep = step * 2 + 1;\n\n    var A2, A1B2, B1, C1, C2;\n    var u, v, uu, vv;\n    uu = vv = 0;\n    var wMax = width - step - 1;\n    var hMax = height - step - 1;\n    var globalY, globalX, localY, localX;\n\n    for (globalY = step + 1; globalY < hMax; globalY += winStep) {\n        for (globalX = step + 1; globalX < wMax; globalX += winStep) {\n            A2 = A1B2 = B1 = C1 = C2 = 0;\n\n            for (localY = -step; localY <= step; localY++) {\n                for (localX = -step; localX <= step; localX++) {\n                    var address = (globalY + localY) * width + globalX + localX;\n\n                    var gradX = (newImage[(address - 1) * 4]) - (newImage[(address + 1) * 4]);\n                    var gradY = (newImage[(address - width) * 4]) - (newImage[(address + width) * 4]);\n                    var gradT = (oldImage[address * 4]) - (newImage[address * 4]);\n\n                    A2 += gradX * gradX;\n                    A1B2 += gradX * gradY;\n                    B1 += gradY * gradY;\n                    C2 += gradX * gradT;\n                    C1 += gradY * gradT;\n                }\n            }\n\n            var delta = (A1B2 * A1B2 - A2 * B1);\n\n            if (delta !== 0) {\n                /* system is not singular - solving by Kramer method */\n                var Idelta = step / delta;\n                var deltaX = -(C1 * A1B2 - C2 * B1);\n                var deltaY = -(A1B2 * C2 - A2 * C1);\n\n                u = deltaX * Idelta;\n                v = deltaY * Idelta;\n            } else {\n                /* singular system - find optical flow in gradient direction */\n                var norm = (A1B2 + A2) * (A1B2 + A2) + (B1 + A1B2) * (B1 + A1B2);\n                if (norm !== 0) {\n                    var IGradNorm = step / norm;\n                    var temp = -(C1 + C2) * IGradNorm;\n\n                    u = (A1B2 + A2) * temp;\n                    v = (B1 + A1B2) * temp;\n                } else {\n                    u = v = 0;\n                }\n            }\n\n            \n\n            if (-winStep < u && u < winStep &&\n                -winStep < v && v < winStep) {\n                uu += u;\n                vv += v;\n                zones.push(new FlowZone(globalX, globalY, u, v));\n            }\n        }\n    }\n\n    return {\n        zones : zones,\n        u : uu / zones.length,\n        v : vv / zones.length\n    };\n};\n","module.exports = FlowZone;\n\nfunction FlowZone(x, y, u, v) {\n    this.x = x;\n    this.y = y;\n    this.u = u;\n    this.v = v;\n}\n"],"sourceRoot":""}